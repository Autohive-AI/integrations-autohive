{
    "name": "slider",
    "version": "1.0.0",
    "description": "PowerPoint automation integration using python-pptx for creating, modifying, and extracting content from presentations",
    "entry_point": "slider.py",
    "actions": {
        "create_presentation": {
            "display_name": "Create PowerPoint Presentation",
            "description": "Create a new PowerPoint presentation with optional template",
            "input_schema": {
                "type": "object",
                "properties": {
                    "template_path": {
                        "type": "string",
                        "description": "Optional path to template PPTX file"
                    },
                    "title": {
                        "type": "string",
                        "description": "Title for the first slide"
                    },
                    "subtitle": {
                        "type": "string",
                        "description": "Subtitle for the first slide"
                    }
                },
                "required": []
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "Unique identifier for the created presentation"
                    },
                    "slide_count": {
                        "type": "integer",
                        "description": "Number of slides in the presentation"
                    }
                },
                "required": ["presentation_id", "slide_count"]
            }
        },
        "add_slide": {
            "display_name": "Add Slide",
            "description": "Add a new slide to an existing presentation",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "ID of the presentation to modify"
                    },
                    "layout": {
                        "type": "string",
                        "enum": ["title", "title_content", "section_header", "two_content", "comparison", "title_only", "blank", "content_with_caption", "picture_with_caption"],
                        "description": "Slide layout type",
                        "default": "blank"
                    },
                    "title": {
                        "type": "string",
                        "description": "Title for the slide"
                    },
                    "content": {
                        "type": "string",
                        "description": "Content text for the slide"
                    }
                },
                "required": ["presentation_id"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "slide_index": {
                        "type": "integer",
                        "description": "Index of the newly added slide"
                    },
                    "slide_count": {
                        "type": "integer",
                        "description": "Total number of slides in presentation"
                    }
                },
                "required": ["slide_index", "slide_count"]
            }
        },
        "add_text": {
            "display_name": "Add Text",
            "description": "Add formatted text to a slide",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "ID of the presentation"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "Index of the slide (0-based)"
                    },
                    "text": {
                        "type": "string",
                        "description": "Text content to add"
                    },
                    "position": {
                        "type": "object",
                        "properties": {
                            "left": {"type": "number", "description": "Left position in inches"},
                            "top": {"type": "number", "description": "Top position in inches"},
                            "width": {"type": "number", "description": "Width in inches"},
                            "height": {"type": "number", "description": "Height in inches"}
                        },
                        "required": ["left", "top", "width", "height"]
                    },
                    "formatting": {
                        "type": "object",
                        "properties": {
                            "font_size": {"type": "integer", "description": "Font size in points"},
                            "bold": {"type": "boolean", "description": "Bold text"},
                            "italic": {"type": "boolean", "description": "Italic text"},
                            "color": {"type": "string", "description": "Text color in hex format (e.g., #FF0000)"}
                        }
                    }
                },
                "required": ["presentation_id", "slide_index", "text", "position"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "shape_id": {
                        "type": "string",
                        "description": "ID of the created text shape"
                    }
                },
                "required": ["shape_id"]
            }
        },
        "add_image": {
            "display_name": "Add Image",
            "description": "Insert an image into a slide",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "ID of the presentation"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "Index of the slide (0-based)"
                    },
                    "image_path": {
                        "type": "string",
                        "description": "Path to the image file"
                    },
                    "position": {
                        "type": "object",
                        "properties": {
                            "left": {"type": "number", "description": "Left position in inches"},
                            "top": {"type": "number", "description": "Top position in inches"},
                            "width": {"type": "number", "description": "Width in inches (optional)"},
                            "height": {"type": "number", "description": "Height in inches (optional)"}
                        },
                        "required": ["left", "top"]
                    }
                },
                "required": ["presentation_id", "slide_index", "image_path", "position"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "shape_id": {
                        "type": "string",
                        "description": "ID of the created image shape"
                    }
                },
                "required": ["shape_id"]
            }
        },
        "add_table": {
            "display_name": "Add Table",
            "description": "Create a table in a slide",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "ID of the presentation"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "Index of the slide (0-based)"
                    },
                    "rows": {
                        "type": "integer",
                        "description": "Number of rows",
                        "minimum": 1
                    },
                    "cols": {
                        "type": "integer",
                        "description": "Number of columns",
                        "minimum": 1
                    },
                    "position": {
                        "type": "object",
                        "properties": {
                            "left": {"type": "number", "description": "Left position in inches"},
                            "top": {"type": "number", "description": "Top position in inches"},
                            "width": {"type": "number", "description": "Table width in inches"},
                            "height": {"type": "number", "description": "Table height in inches"}
                        },
                        "required": ["left", "top", "width", "height"]
                    },
                    "data": {
                        "type": "array",
                        "description": "2D array of table data",
                        "items": {
                            "type": "array",
                            "items": {"type": "string"}
                        }
                    }
                },
                "required": ["presentation_id", "slide_index", "rows", "cols", "position"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "table_id": {
                        "type": "string",
                        "description": "ID of the created table"
                    }
                },
                "required": ["table_id"]
            }
        },
        "add_chart": {
            "display_name": "Add Chart",
            "description": "Create a chart in a slide",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "ID of the presentation"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "Index of the slide (0-based)"
                    },
                    "chart_type": {
                        "type": "string",
                        "enum": ["column_clustered", "line", "pie", "bar_clustered", "area", "xy_scatter"],
                        "description": "Type of chart to create"
                    },
                    "position": {
                        "type": "object",
                        "properties": {
                            "left": {"type": "number", "description": "Left position in inches"},
                            "top": {"type": "number", "description": "Top position in inches"},
                            "width": {"type": "number", "description": "Chart width in inches"},
                            "height": {"type": "number", "description": "Chart height in inches"}
                        },
                        "required": ["left", "top", "width", "height"]
                    },
                    "data": {
                        "type": "object",
                        "properties": {
                            "categories": {
                                "type": "array",
                                "items": {"type": "string"},
                                "description": "Chart categories/labels"
                            },
                            "series": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "name": {"type": "string"},
                                        "values": {
                                            "type": "array",
                                            "items": {"type": "number"}
                                        }
                                    },
                                    "required": ["name", "values"]
                                },
                                "description": "Chart data series"
                            }
                        },
                        "required": ["categories", "series"]
                    }
                },
                "required": ["presentation_id", "slide_index", "chart_type", "position", "data"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "chart_id": {
                        "type": "string",
                        "description": "ID of the created chart"
                    }
                },
                "required": ["chart_id"]
            }
        },
        "extract_text": {
            "display_name": "Extract Text",
            "description": "Extract all text content from a presentation",
            "input_schema": {
                "type": "object",
                "properties": {
                    "file_path": {
                        "type": "string",
                        "description": "Path to the PowerPoint file"
                    }
                },
                "required": ["file_path"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "slides": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "slide_index": {"type": "integer"},
                                "text_content": {
                                    "type": "array",
                                    "items": {"type": "string"}
                                }
                            }
                        },
                        "description": "Text content from each slide"
                    },
                    "all_text": {
                        "type": "string",
                        "description": "All text content combined"
                    }
                },
                "required": ["slides", "all_text"]
            }
        },
        "modify_slide": {
            "display_name": "Modify Slide",
            "description": "Update content in an existing slide",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "ID of the presentation"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "Index of the slide to modify (0-based)"
                    },
                    "updates": {
                        "type": "object",
                        "properties": {
                            "title": {"type": "string", "description": "New title text"},
                            "replace_text": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "old_text": {"type": "string"},
                                        "new_text": {"type": "string"}
                                    },
                                    "required": ["old_text", "new_text"]
                                },
                                "description": "Text replacements to make"
                            }
                        }
                    }
                },
                "required": ["presentation_id", "slide_index", "updates"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "modified": {
                        "type": "boolean",
                        "description": "Whether the slide was successfully modified"
                    }
                },
                "required": ["modified"]
            }
        },
        "save_presentation": {
            "display_name": "Save Presentation",
            "description": "Save a presentation to file",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "ID of the presentation to save"
                    },
                    "file_path": {
                        "type": "string",
                        "description": "Path where to save the presentation"
                    }
                },
                "required": ["presentation_id", "file_path"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "saved": {
                        "type": "boolean",
                        "description": "Whether the presentation was successfully saved"
                    },
                    "file_path": {
                        "type": "string",
                        "description": "Path where the presentation was saved"
                    },
                    "file": {
                        "type": "object",
                        "description": "The saved presentation file for streaming",
                        "properties": {
                            "content": {
                                "type": "string",
                                "description": "The file content encoded as base64"
                            },
                            "name": {
                                "type": "string",
                                "description": "The name of the file"
                            },
                            "contentType": {
                                "type": "string",
                                "description": "The content type of the file"
                            }
                        },
                        "required": ["content", "name", "contentType"]
                    },
                    "error": {
                        "type": "string",
                        "description": "Error message if file streaming failed"
                    }
                },
                "required": ["saved", "file_path", "file"]
            }
        },
        "set_text_autosize": {
            "display_name": "Set Text Autosize",
            "description": "Set automatic text sizing behavior for a text box or shape",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "The presentation ID"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "The slide index (0-based)"
                    },
                    "shape_index": {
                        "type": "integer",
                        "description": "The shape index (0-based)"
                    },
                    "autosize_type": {
                        "type": "string",
                        "enum": ["NONE", "SHAPE_TO_FIT_TEXT", "TEXT_TO_FIT_SHAPE"],
                        "description": "Type of automatic sizing: NONE (no auto-sizing), SHAPE_TO_FIT_TEXT (resize shape to fit text), TEXT_TO_FIT_SHAPE (resize text to fit shape)"
                    },
                    "word_wrap": {
                        "type": "boolean",
                        "description": "Whether to enable word wrapping (optional)"
                    }
                },
                "required": ["presentation_id", "slide_index", "shape_index", "autosize_type"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the operation was successful"
                    },
                    "autosize_type": {
                        "type": "string",
                        "description": "The autosize type that was set"
                    },
                    "word_wrap": {
                        "type": "boolean",
                        "description": "The current word wrap setting"
                    }
                },
                "required": ["success", "autosize_type"]
            }
        },
        "fit_text_to_shape": {
            "display_name": "Fit Text to Shape",
            "description": "Automatically resize text to fit within the shape boundaries",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "The presentation ID"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "The slide index (0-based)"
                    },
                    "shape_index": {
                        "type": "integer",
                        "description": "The shape index (0-based)"
                    },
                    "max_size": {
                        "type": "number",
                        "description": "Maximum font size in points (default: 48)",
                        "minimum": 1,
                        "maximum": 144
                    }
                },
                "required": ["presentation_id", "slide_index", "shape_index"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the operation was successful"
                    },
                    "max_size": {
                        "type": "number",
                        "description": "The maximum font size used"
                    },
                    "auto_size": {
                        "type": "string",
                        "description": "The auto-sizing mode applied"
                    }
                },
                "required": ["success", "max_size", "auto_size"]
            }
        },
        "set_text_margins": {
            "display_name": "Set Text Margins",
            "description": "Set the margins for a text box or shape",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "The presentation ID"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "The slide index (0-based)"
                    },
                    "shape_index": {
                        "type": "integer",
                        "description": "The shape index (0-based)"
                    },
                    "margins": {
                        "type": "object",
                        "properties": {
                            "left": {
                                "type": "number",
                                "description": "Left margin in inches"
                            },
                            "right": {
                                "type": "number",
                                "description": "Right margin in inches"
                            },
                            "top": {
                                "type": "number",
                                "description": "Top margin in inches"
                            },
                            "bottom": {
                                "type": "number",
                                "description": "Bottom margin in inches"
                            }
                        },
                        "description": "Margin settings (at least one margin must be specified)"
                    }
                },
                "required": ["presentation_id", "slide_index", "shape_index", "margins"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the operation was successful"
                    },
                    "margins_set": {
                        "type": "object",
                        "description": "The margins that were set"
                    }
                },
                "required": ["success", "margins_set"]
            }
        },
        "set_text_alignment": {
            "display_name": "Set Text Alignment",
            "description": "Set the vertical alignment for text within a shape",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "The presentation ID"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "The slide index (0-based)"
                    },
                    "shape_index": {
                        "type": "integer",
                        "description": "The shape index (0-based)"
                    },
                    "vertical_anchor": {
                        "type": "string",
                        "enum": ["TOP", "MIDDLE", "BOTTOM"],
                        "description": "Vertical alignment of text within the shape"
                    }
                },
                "required": ["presentation_id", "slide_index", "shape_index"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the operation was successful"
                    },
                    "vertical_anchor": {
                        "type": "string",
                        "description": "The vertical anchor that was set"
                    }
                },
                "required": ["success"]
            }
        },
        "set_slide_background_color": {
            "display_name": "Set Slide Background Color",
            "description": "Set a solid color background for a slide",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "The presentation ID"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "The slide index (0-based)"
                    },
                    "color": {
                        "description": "Color specification",
                        "oneOf": [
                            {
                                "type": "string",
                                "pattern": "^#[0-9A-Fa-f]{6}$",
                                "description": "Hex color code (e.g., '#FF0000' for red)"
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "rgb": {
                                        "type": "array",
                                        "items": {"type": "integer", "minimum": 0, "maximum": 255},
                                        "minItems": 3,
                                        "maxItems": 3,
                                        "description": "RGB color values [r, g, b]"
                                    }
                                },
                                "required": ["rgb"],
                                "additionalProperties": false
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "theme_color": {
                                        "type": "string",
                                        "enum": ["ACCENT_1", "ACCENT_2", "ACCENT_3", "ACCENT_4", "ACCENT_5", "ACCENT_6", "BACKGROUND_1", "BACKGROUND_2", "DARK_1", "DARK_2", "LIGHT_1", "LIGHT_2"],
                                        "description": "PowerPoint theme color"
                                    }
                                },
                                "required": ["theme_color"],
                                "additionalProperties": false
                            }
                        ]
                    }
                },
                "required": ["presentation_id", "slide_index", "color"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the operation was successful"
                    },
                    "color_set": {
                        "description": "The color that was applied"
                    },
                    "follow_master_background": {
                        "type": "boolean",
                        "description": "Whether the slide follows master background"
                    }
                },
                "required": ["success", "color_set", "follow_master_background"]
            }
        },
        "set_slide_background_gradient": {
            "display_name": "Set Slide Background Gradient",
            "description": "Set a gradient background for a slide",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "The presentation ID"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "The slide index (0-based)"
                    },
                    "angle": {
                        "type": "number",
                        "description": "Gradient angle in degrees (0=left-to-right, 90=bottom-to-top)",
                        "minimum": 0,
                        "maximum": 360
                    },
                    "gradient_stops": {
                        "type": "array",
                        "description": "Gradient color stops (optional, uses default if not provided)",
                        "items": {
                            "type": "object",
                            "properties": {
                                "position": {
                                    "type": "number",
                                    "minimum": 0,
                                    "maximum": 1,
                                    "description": "Position of the stop (0.0 to 1.0)"
                                },
                                "color": {
                                    "oneOf": [
                                        {
                                            "type": "object",
                                            "properties": {
                                                "rgb": {
                                                    "type": "array",
                                                    "items": {"type": "integer", "minimum": 0, "maximum": 255},
                                                    "minItems": 3,
                                                    "maxItems": 3
                                                }
                                            },
                                            "required": ["rgb"]
                                        },
                                        {
                                            "type": "object",
                                            "properties": {
                                                "theme_color": {
                                                    "type": "string",
                                                    "enum": ["ACCENT_1", "ACCENT_2", "ACCENT_3", "ACCENT_4", "ACCENT_5", "ACCENT_6"]
                                                }
                                            },
                                            "required": ["theme_color"]
                                        }
                                    ]
                                }
                            }
                        }
                    }
                },
                "required": ["presentation_id", "slide_index"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the operation was successful"
                    },
                    "gradient_angle": {
                        "type": "number",
                        "description": "The gradient angle that was set"
                    },
                    "gradient_stops_applied": {
                        "type": "integer",
                        "description": "Number of gradient stops applied"
                    },
                    "follow_master_background": {
                        "type": "boolean",
                        "description": "Whether the slide follows master background"
                    }
                },
                "required": ["success", "gradient_angle", "gradient_stops_applied", "follow_master_background"]
            }
        },
        "add_background_image_workaround": {
            "display_name": "Add Background Image (Workaround)",
            "description": "Add an image as slide background using full-slide picture workaround",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "The presentation ID"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "The slide index (0-based)"
                    },
                    "image_data": {
                        "type": "string",
                        "description": "Base64 encoded image data"
                    }
                },
                "required": ["presentation_id", "slide_index", "image_data"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the operation was successful"
                    },
                    "method": {
                        "type": "string",
                        "description": "The method used to add the background"
                    },
                    "picture_width": {
                        "type": "number",
                        "description": "Width of the background picture"
                    },
                    "picture_height": {
                        "type": "number",
                        "description": "Height of the background picture"
                    },
                    "note": {
                        "type": "string",
                        "description": "Important note about usage"
                    }
                },
                "required": ["success", "method", "picture_width", "picture_height", "note"]
            }
        },
        "reset_slide_background": {
            "display_name": "Reset Slide Background",
            "description": "Reset slide background to inherit from master/layout",
            "input_schema": {
                "type": "object",
                "properties": {
                    "presentation_id": {
                        "type": "string",
                        "description": "The presentation ID"
                    },
                    "slide_index": {
                        "type": "integer",
                        "description": "The slide index (0-based)"
                    }
                },
                "required": ["presentation_id", "slide_index"]
            },
            "output_schema": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the operation was successful"
                    },
                    "follow_master_background": {
                        "type": "boolean",
                        "description": "Whether the slide now follows master background"
                    },
                    "note": {
                        "type": "string",
                        "description": "Information about the reset operation"
                    }
                },
                "required": ["success", "follow_master_background", "note"]
            }
        }
    }
}